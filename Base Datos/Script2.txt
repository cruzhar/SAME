--LISTAR
--CREAR
--MODIFICAR
--ELIMINAR

CREATE PROC TB_EMPRESA_L_SP

@NOMBRE VARCHAR(50)

AS
BEGIN

	IF @NOMBRE = ''
		SELECT * FROM TB_EMPRESA WHERE ESTADO = 1
	ELSE
		SELECT * FROM TB_EMPRESA WHERE 
		ESTADO = 1 AND 
		NOMBRE_EMPRESA LIKE '%' + @NOMBRE + '%'


END;

--EJECUCION
EXEC TB_EMPRESA_L_SP ''


EXEC TB_EMPRESA_L_SP 'SA'


--PROCEDIMIENTO DE INSERTAR
CREATE PROC TB_EMPRESA_I_SP

@NOMBRE_EMRESA VARCHAR(50),
@DIRECCION_EMPRESA VARCHAR(200),
@TELEFONO_EMPRESA VARCHAR(20)

AS
BEGIN

	INSERT INTO TB_EMPRESA
	(NOMBRE_EMPRESA,DIRECCION_EMPRESA,TELEFONO_EMPRESA)
	VALUES
	(@NOMBRE_EMRESA,@DIRECCION_EMPRESA,@TELEFONO_EMPRESA)


END;

--EJECUCION
EXEC TB_EMPRESA_I_SP 'AGENCIA','COLOMBIA',''

SELECT * FROM TB_EMPRESA


-- ACTUALIZAR
CREATE PROC TB_EMPRESA_U_SP
@ID_EMPRESA INT,
@NOMBRE_EMRESA VARCHAR(50),
@DIRECCION_EMPRESA VARCHAR(200),
@TELEFONO_EMPRESA VARCHAR(20)
AS
BEGIN

	UPDATE TB_EMPRESA SET
	NOMBRE_EMPRESA= @NOMBRE_EMRESA,
	DIRECCION_EMPRESA = @DIRECCION_EMPRESA,
	TELEFONO_EMPRESA = @TELEFONO_EMPRESA
	WHERE ID_EMPRESA = @ID_EMPRESA



END;


-- ACTUALIZAR
EXEC TB_EMPRESA_U_SP 7,'AGENCIA','COLOMBIA','564564564'
SELECT * FROM TB_EMPRESA


--ELIMINAR UN REGISTRO

CREATE PROC TB_EMPRESA_D_SP
@ID_EMPRESA INT
AS
BEGIN


	UPDATE TB_EMPRESA SET
	ESTADO = 0
	WHERE ID_EMPRESA = @ID_EMPRESA
END

EJECUTAR
EXEC TB_EMPRESA_D_SP 7
SELECT * FROM TB_EMPRESA WHERE ESTADO = 1
